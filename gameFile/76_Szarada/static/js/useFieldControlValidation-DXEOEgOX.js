import{a as c}from"./chunk-NISHYRIK-jpzqUR05.js";import{aE as J,u as U,b as k,m as N,F as Y,aI as A,aJ as h,p as z,q as G}from"./Modal-DaeVzZWw.js";import{a as O}from"./index-MBj41598.js";function oe({controlled:e,default:t,name:o,state:b="value"}){const{current:n}=c.useRef(e!==void 0),[l,f]=c.useState(t),p=n?e:l,r=c.useCallback(u=>{n||f(u)},[]);return[p,r]}const Q=c.createContext(void 0);function X(e=!1){const t=c.useContext(Q);if(t===void 0&&!e)throw new Error("Base UI: CompositeRootContext is missing. Composite parts must be placed within <Composite.Root>.");return t}function re(e){return J(e,"base-ui")}function Z(e){const{focusableWhenDisabled:t,disabled:o,composite:b=!1,tabIndex:n=0,isNativeButton:l}=e,f=b&&t!==!1,p=b&&t===!1;return{props:c.useMemo(()=>{const u={onKeyDown(C){o&&t&&C.key!=="Tab"&&C.preventDefault()}};return b||(u.tabIndex=n,!l&&o&&(u.tabIndex=t?n:-1)),(l&&(t||f)||!l&&o)&&(u["aria-disabled"]=o),l&&(!t||p)&&(u.disabled=o),u},[b,o,t,f,p,l,n])}}function le(e={}){const{disabled:t=!1,focusableWhenDisabled:o,tabIndex:b=0,native:n=!0}=e,l=c.useRef(null),f=X(!0)!==void 0,p=U(()=>{const i=l.current;return!!((i==null?void 0:i.tagName)==="A"&&(i!=null&&i.href))}),{props:r}=Z({focusableWhenDisabled:o,disabled:t,composite:f,tabIndex:b,isNativeButton:n}),u=c.useCallback(()=>{const i=l.current;$(i)&&f&&t&&r.disabled===void 0&&i.disabled&&(i.disabled=!1)},[t,r.disabled,f]);k(u,[u]);const C=c.useCallback((i={})=>{const{onClick:s,onMouseDown:g,onKeyUp:y,onKeyDown:E,onPointerDown:R,...D}=i;return N({type:n?"button":void 0,onClick(a){if(t){a.preventDefault();return}s==null||s(a)},onMouseDown(a){t||g==null||g(a)},onKeyDown(a){if(t||(A(a),E==null||E(a)),a.baseUIHandlerPrevented)return;const F=a.target===a.currentTarget&&!n&&!p()&&!t,m=a.key==="Enter",T=a.key===" ";F&&((T||m)&&a.preventDefault(),m&&(s==null||s(a)))},onKeyUp(a){t||(A(a),y==null||y(a)),!a.baseUIHandlerPrevented&&a.target===a.currentTarget&&!n&&!t&&a.key===" "&&(s==null||s(a))},onPointerDown(a){if(t){a.preventDefault();return}R==null||R(a)}},n?void 0:{role:"button"},r,D)},[t,r,n,p]),I=U(i=>{l.current=i,u()});return{getButtonProps:C,buttonRef:I}}function $(e){return Y(e)&&e.tagName==="BUTTON"}let H=(function(e){return e.disabled="data-disabled",e.valid="data-valid",e.invalid="data-invalid",e.touched="data-touched",e.dirty="data-dirty",e.filled="data-filled",e.focused="data-focused",e})({});const L={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:null,valueMissing:!1},ue={valid(e){return e===null?null:e?{[H.valid]:""}:{[H.invalid]:""}}},ee=c.createContext({invalid:void 0,controlId:void 0,setControlId:h,labelId:void 0,setLabelId:h,messageIds:[],setMessageIds:h,name:void 0,validityData:{state:L,errors:[],error:"",value:"",initialValue:null},setValidityData:h,disabled:void 0,touched:!1,setTouched:h,dirty:!1,setDirty:h,filled:!1,setFilled:h,focused:!1,setFocused:h,validate:()=>null,validationMode:"onBlur",validationDebounceTime:0,state:{disabled:!1,valid:null,touched:!1,dirty:!1,filled:!1,focused:!1},markedDirtyRef:{current:!1}});function _(e=!0){const t=c.useContext(ee);if(t.setControlId===h&&!e)throw new Error("Base UI: FieldRootContext is missing. Field parts must be placed within <Field.Root>.");return t}const te=c.createContext({formRef:{current:{fields:new Map}},errors:{},clearErrors:h});function q(){return c.useContext(te)}function S(e,t){return{...e,state:{...e.state,valid:!t&&e.state.valid}}}function de(e){const{formRef:t}=q(),{invalid:o,markedDirtyRef:b,validityData:n,setValidityData:l}=_(),{enabled:f=!0,value:p,id:r,name:u,controlRef:C,commitValidation:I}=e,i=z(e.getValue);k(()=>{var g;if(!f)return;let s=p;s===void 0&&(s=(g=i.current)==null?void 0:g.call(i)),n.initialValue===null&&s!==n.initialValue&&l(y=>({...y,initialValue:s}))},[f,l,p,n.initialValue,i]),k(()=>{f&&r&&t.current.fields.set(r,{controlRef:C,validityData:S(n,o),validate(){var g;let s=p;s===void 0&&(s=(g=i.current)==null?void 0:g.call(i)),b.current=!0,O.flushSync(()=>I(s))},getValueRef:i,name:u})},[I,C,f,t,i,r,o,b,u,n,p]),k(()=>{const s=t.current.fields;return()=>{r&&s.delete(r)}},[t,r])}const w=Object.keys(L);function ae(e){if(!e||e.valid||!e.valueMissing)return!1;let t=!1;for(const o of w)o!=="valid"&&(o==="valueMissing"&&(t=e[o]),e[o]&&(t=!1));return t}function fe(){const{setValidityData:e,validate:t,messageIds:o,validityData:b,validationMode:n,validationDebounceTime:l,invalid:f,markedDirtyRef:p,controlId:r,state:u,name:C}=_(),{formRef:I,clearErrors:i}=q(),s=G(),g=c.useRef(null),y=U(async(D,x=!1)=>{const a=g.current;if(!a)return;if(x){if(u.valid!==!1)return;const M=a.validity;if(!M.valueMissing){const V={value:D,state:{...L,valid:!0},error:"",errors:[],initialValue:b.initialValue};if(a.setCustomValidity(""),r){const d=I.current.fields.get(r);d&&I.current.fields.set(r,{...d,...S(V,!1)})}e(V);return}const v=w.reduce((V,d)=>(V[d]=M[d],V),{});if(!v.valid&&!ae(v))return}function F(M){const v=w.reduce((d,P)=>(d[P]=M.validity[P],d),{});let V=!1;for(const d of w)if(d!=="valid"){if(d==="valueMissing"&&v[d])V=!0;else if(v[d])return v}return V&&!p.current&&(v.valid=!0,v.valueMissing=!1),v}s.clear();let m=null,T=[];const B=F(a);let K;if(a.validationMessage)K=a.validationMessage,T=[a.validationMessage];else{const M=Array.from(I.current.fields.values()).reduce((V,d)=>{var P,W;return d.name&&d.getValueRef&&(V[d.name]=(W=(P=d.getValueRef).current)==null?void 0:W.call(P)),V},{}),v=t(D,M);typeof v=="object"&&v!==null&&"then"in v?m=await v:m=v,m!==null&&(B.valid=!1,B.customError=!0,Array.isArray(m)?(T=m,a.setCustomValidity(m.join(`
`))):m&&(T=[m],a.setCustomValidity(m)))}const j={value:D,state:B,error:K??(Array.isArray(m)?m[0]:m??""),errors:T,initialValue:b.initialValue};if(r){const M=I.current.fields.get(r);M&&I.current.fields.set(r,{...M,...S(j,f)})}e(j)}),E=c.useCallback((D={})=>N({...o.length&&{"aria-describedby":o.join(" ")},...u.valid===!1&&{"aria-invalid":!0}},D),[o,u.valid]),R=c.useCallback((D={})=>N({onChange(x){if(x.nativeEvent.defaultPrevented)return;if(i(C),n!=="onChange"){y(x.currentTarget.value,!0);return}if(f)return;const a=x.currentTarget;if(a.value===""){y(a.value);return}s.clear(),l?s.start(l,()=>{y(a.value)}):y(a.value)}},E(D)),[E,i,C,s,y,f,n,l]);return c.useMemo(()=>({getValidationProps:E,getInputValidationProps:R,inputRef:g,commitValidation:y}),[E,R,y])}export{Q as C,_ as a,fe as b,re as c,oe as d,de as e,ue as f,le as g,X as h,q as u};
