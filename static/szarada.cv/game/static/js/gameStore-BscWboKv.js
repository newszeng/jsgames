import{q as S,a as u,p as m}from"./chunk-NISHYRIK-jpzqUR05.js";import{u as v,a as x,s as w,i as C}from"./locationStore-DrI_YTJV.js";import{g as P,a as W}from"./words-CIvxWwuZ.js";const L=(e,t={})=>fetch(e,{method:"POST",headers:{Accept:"application/json","Content-type":"application/json"},body:JSON.stringify(t)}),E={archiwum:"/archiwum",answers:"rozwiazania",help:"zasady"},O=()=>{const{pathname:e}=S();return e.includes(E.archiwum)},j=6,T=5,D={4:"grid-cols-4 grid gap-x-1",5:"grid-cols-5 grid gap-x-1",6:"grid-cols-6 grid gap-x-1"};function A(e){return x()(w(C(()=>e)))}function R(){const e=u.createContext(null),t=u.createContext(null);function n(s){const o=u.useContext(e);if(!o)throw new Error("Missing GameProvider in the tree");return v(o,s||(i=>i))}function r(){const s=u.useContext(e);if(!s)throw new Error("Missing GameProvider in the tree");return s}function c(){const s=u.useContext(t);if(!s)throw new Error("Missing GameProvider in the tree");return s}function a({children:s,game:o,reload:i=!1,createGame:d,createGameActions:g}){const l=u.useRef(null),p=u.useRef(null);if(!o)return null;if(!l.current||i){const h=d(o);l.current=A(h),p.current=g(l.current)}return m.jsx(e.Provider,{value:l.current,children:m.jsx(t.Provider,{value:p.current,children:s})})}return{useGameState:n,useGameStore:r,useGameActions:c,GameProvider:a}}const y=e=>e.guesses.includes(e.solution.toLocaleUpperCase())?"won":e.guesses.length===j?"lost":e.guesses.length>0||e.invalids.length>0?"playing":"pending",G=e=>{const{id:t,guesses:n,invalids:r,solution:c,date:a,finished:s}=e,o={gameId:t,gameDate:a,stats:{status:y(e),guesses:n,invalids:r,solution:c,finished:s}};L("/api/szarada/update-stats",o)},{useGameState:f,useGameActions:H,GameProvider:I}=R(),b=e=>{const t=P(e.id),{id:n,guesses:r=[],invalids:c=[],status:a="pending",date:s="",finished:o=!1}=e,i=r.includes(t==null?void 0:t.toUpperCase()),d=r.length===6&&!i;return{id:n,guesses:r,invalids:c,solution:t,status:a,date:s,isGameWon:i,isGameLost:d,finished:o}},z=e=>{const{setState:t,getState:n}=e;return{addGuess:r=>{t(d=>{r&&!W(r)?d.invalids.push(r):d.guesses.push(r)});const c=n(),{guesses:a,solution:s}=c,o=a.includes(s==null?void 0:s.toUpperCase()),i=a.length===6&&!o;return t({isGameWon:o,isGameLost:i}),G(n()),n().guesses},markFinished:()=>{t({finished:!0}),G(n())}}},_=()=>f(e=>e.isGameWon),k=()=>f(e=>e.isGameLost);function q({children:e,game:t,reload:n=!1}){return m.jsx(I,{game:t,reload:n,createGame:b,createGameActions:z,children:e})}export{q as G,T as W,k as a,f as b,O as c,H as d,E as e,D as f,j as g,L as p,_ as u};
